-- WITH vals AS (VALUES('sesenwnenenewseeswwswswwnenewsewsw'),('neeenesenwnwwswnenewnwwsewnenwseswesw'),('seswneswswsenwwnwse'),('nwnwneseeswswnenewneswwnewseswneseene'),('swweswneswnenwsewnwneneseenw'),('eesenwseswswnenwswnwnwsewwnwsene'),('sewnenenenesenwsewnenwwwse'),('wenwwweseeeweswwwnwwe'),('wsweesenenewnwwnwsenewsenwwsesesenwne'),('neeswseenwwswnwswswnw'),('nenwswwsewswnenenewsenwsenwnesesenew'),('enewnwewneswsewnwswenweswnenwsenwsw'),('sweneswneswneneenwnewenewwneswswnese'),('swwesenesewenwneswnwwneseswwne'),('enesenwswwswneneswsenwnewswseenwsese'),('wnwnesenesenenwwnenwsewesewsesesew'),('nenewswnwewswnenesenwnesewesw'),('eneswnwswnwsenenwnwnwwseeswneewsenese'),('neswnwewnwnwseenwseesewsenwsweewe'),('wseweeenwnesenwwwswnew')),
WITH vals AS (VALUES('eweneeewwneeeneneseweeeee'),('eenweesewseweene'),('nenwnenenenenenenwewnwwwnenwnwnwese'),('seseseeneseseseswneeswseseseseseseesese'),('nwsewewwwwewwwwwnwnwwwnwwsww'),('weseeewwnwwwswnwswnwewneswnwnwswsw'),('eeeweneeeeneeeee'),('eneswswneswwsenwwsenweswnwswswswsesw'),('nwseeeeewneswswsesenweeenweeee'),('swswnwnwseswneseswswnwsenenwsenwswwese'),('nwswsenesewnwwnwnewnenwwwwwnwwse'),('swwsesesesenwseswswswswseseseseeeswnwse'),('neneneeneenenenwnenenenwseswnenee'),('swnenwnenenwnenwewwswnweenwnwnwnwnese'),('swsewseseswseeswswseswsese'),('wnewnweneenenenwsenenenesweswwneswnw'),('nwenenwnenwnwnwnwswnenw'),('esesesesesesesesesesesesesesesenwsese'),('nenwnwnwnwenwnenwnwnwnwsenenwnwswnenwse'),('eewnenesenwneswenewneneneeeewne'),('ewwneseeeeneneeneneneneenenenenene'),('eweseseeneneneeswnwwnenewneneenee'),('sesweswnenwwnwsewnwnwnweewseeswwe'),('seeeseneeweeseee'),('swseneneewwnenwwwwnwsesese'),('neenweeseneswseseswwwnweneeweese'),('eeeseswseseeeeeeeeneeeenwese'),('wnenenenewneeneneenenenesenene'),('nwnwnewwsesenenwnwwwewwwwwwnw'),('wneswswwswswswwswswswwseswsww'),('nenenesenwneswwwnwnwnwswswwnwenewse'),('neenenenenenenenenwswnenwnwsenenenenewnene'),('wwswwsewnenewsewwwwwwwnwswse'),('wwwwwwwwwewewwwwwwwsw'),('nwneweseeseeneseeeneesewewwe'),('swwenwnenwnwewwseeesenwswnwwwsw'),('wwswwwsewweswswwneneewswwswwsww'),('swnwswenwseswswswswswnwswseswswswswsese'),('eeeneeneswnenwneenenesee'),('enwnwnenwnesenwnwwenwnwswswnwwe'),('nwnenenenenwnwnwswswseneneneswnwnwswnene'),('seseeenweweenenwneeneneeeeseene'),('nenwnenenenwneeenenwnewswnenw'),('wswneewswswneneswsewswseneseswswseswsw'),('wewenesweeeeeneneweneneeenese'),('senwnwnenwenwnwwnenwsesenwnwnwnwnwsenw'),('seneeneeswseneenwenwnwswneeneenwe'),('senenwsenesewswwseseswseneseswswnenwswe'),('wwswewwenweewwwwwswneswww'),('swwnwnwneneneneeneneneneenwswnenenww'),('nwwnwwsenwnwnwswnwwwsenwwnewwww'),('nwswswnwenwseeeewsenwseenese'),('eweeseeeswenwnweswenwnewwsew'),('neeswenweseeeeeeseeeee'),('nesenwenenwnesenwwneneneneneneneswnene'),('swswswswswswseswswneswwswneneswswsewsw'),('eeeenweesweeeseeeeee'),('nwenesenwneswnewsenenwwnwsewswwnewse'),('seeeseseenwseeswwseseswwenesesese'),('wewnwnwwwwwwenwwwwwwwwww'),('enwswswswnwnwneeeewseeseeeseseese'),('newenwnenwewswnenwnwnwnwnwnwnenenwnenw'),('wwnwnwnwswnwnwwwnwnwsenwnwewnwnwww'),('nwnwswnwnwwwwwwwnwwwnwnewsewww'),('swsenweeeseseseweneeeseseswseseenw'),('sesenwseeneseseweseseseseesewnweese'),('seeneweesewseneeeseseeseseesee'),('swswswswswswswswnwsweswswswswswseswswsw'),('nwseeeseseseesweeeseenwsweseseeee'),('seseseneseseseseseseswnesesesesewsenww'),('wwnewwnwwsewnwewwnw'),('wwwnwwwwswwswwwswsesenw'),('nwnwwwsenwwnwnwnwnwnwnwnwnwwswnwnwe'),('newnenwnenenenwseneneswnenwnenene'),('esweeeneswneneweneseneewwenese'),('sesewnwseseswsesenewseneseeneswsenwe'),('seeeeeeeeeenenenweneeesweene'),('seeswenwseeswswweeenweneneseenene'),('nenwnenenwnenenwnwnenwnwnenwnenenwsw'),('nesenewswsewnwswwswweswswswwswnwewse'),('nwsweswswswwenewwswswwswwswnewsww'),('sewseseswswseseseeseseswseswswesewsw'),('nenenenenenwnwsenwnenenewnwsenwnenwnenw'),('sewwwsewnewweswsenenwwwswenwnenww'),('eewwswwwwwswwwe'),('nwsenwswwnwseenwnwnwnwnwnenwnwwnwww'),('nenwnwnenwnwnenenwnwwseneenwnwnwne'),('neneswswsweswsewswnesewneswwswnenewnw'),('wnwewnwwwwwwwwwneswnwnwnwwwse'),('eswswswswswswswswswswseswnwswswnwswsesw'),('nenenwnenwnenwnenwnwnenenenenenwnwsenenwse'),('nwnwnwnwnesenenwswnwnwnenwnwnenwnwnwnwnenw'),('swswwwwswwwwweswsww'),('enewswwwswwwwswsewwwwwwwswsw'),('wsesesesesesesesewneweswewseswseese'),('neeneneneneenenenweeneneneeeeesw'),('swneneenenenwswewnweneeneneneneneenwsw'),('wwwnwwnwwwnwweweewnwwwwsw'),('nwwsewwnwwwnwnwewwwnwnenwwww'),('enwnenwnenwnenewnwewne'),('nwewseneswneeewnwswenwswsenwswwne'),('wwswnewswswwwswwnwwswseesww'),('swnwnwenwnwnenwswneenwne'),('newnwswwswswswswswwseswseswneswswswsw'),('wswseeswswneswswwswwsweewwwswe'),('neeeeseenwswewweeneneenenenenee'),('wswwewneswswwwwwwnwwwsenwwww'),('swswneswsewewseneesweenwnwseneee'),('swswnwswswwwsewswwwwwwwwww'),('wnwsesesesesesesesesenese'),('nwseeeseneeswsenenweseseeswsesewe'),('esesewewnwseseeeseseeseesee'),('neswnweseswswswnwswswswswnwwneseeswnw'),('enwnwnwwseenenwnwsenwnwwswnwwwnwne'),('swseswseneswneswwnwweswnwwnwseswswse'),('nwneneenenwswnwsewsenwswnwnwnesw'),('swneswseseseswswseseseswseswsesesesenewse'),('swesweeswswswsenwswswnwnwswseswswswsw'),('senenwswnwseseseeseswseenwnwwnwenwe'),('enweneneneswneeneneneneeneneeene'),('sweswseeeeeeeseeesenwnwnwse'),('neneneneeneneneeneneneenewneneneneswne'),('wnesewnwneswwsenwnesenwwswnwenesenww'),('neenewsweweeeeeseeeeeesee'),('nwnwnenwnenwswneewnenenwnenenenwnwsewene'),('eseweseseeeeeeseseeeeeneese'),('swswswswenwwswswswsweswswswswswswnenw'),('wsenenewnenenenenenesenenenenenenenwne'),('enewnwneswnenesewnesenwne'),('wnwwwenwnwnwnwnwnwwnw'),('eeseseswswwnweneweneeeneeeswe'),('nwnesewswswswwwsww'),('eeewnweeeeeeeeneneesesweee'),('wnweswnwnwnwneseswnwnwnwnw'),('nenenenwnenenwnenesenenwsw'),('nwswnewwswsewneswnesewwwwsewswnw'),('eneseeneswneneneeeeenwneeneeene'),('nenenwenenwneenenenwnwnewnwneswnenenwne'),('wseswseswenwneeneseeeseseseesewsenese'),('wnwnwwwwnwswnwenwnwswwwnwwewwww'),('neneeeneneneseeneneneneeeneneeswnenw'),('neneneeeneswneneneeneenenenenesenenew'),('nwwwwnwnwnwnwwnwswnwnwnwwenwnwnww'),('wsewwwwwwnwwwwewwnenwswwwww'),('nwneneesenenenwswnwnewswnenenenenwnenenw'),('seseswsesesenewwnwseswseswneeswnesee'),('eswneneneswnwnenenwsenwnwnenenwnwnenwnwnenw'),('seneesenenweeswwneeneswneswneseenwnw'),('wwwnwnwewnwnwnwnwnwnwnwewnwnwnwnwnw'),('enenewneneneneseneewnwneeewenese'),('enenenenenenenwneneeseneneenenenewswne'),('esesenwseseseseseseseseseswsenwsesesese'),('nwnwwwnwnwwwnwsewneseseswnwnwnwsewne'),('eswnwweeswnenweneseee'),('nwnenwnwsenwnwnwnwsewnwnwnwnwnenwnenenw'),('eneeneswnenenesenenenenenw'),('sesewweseseseeeseseewseneseseee'),('swesenwnwwneeenenwswsweswswwnwnwnww'),('nwnwnwnenwnenenenwwnwnwnenwnwnwnwsenwswnwnw'),('seseseswseswseswswseseswnwseeswswswsenw'),('swseswseswswwswseeneseswseseseseseswsesw'),('sesewseesewneswneesesesenw'),('sesenesweseseseseswwseseswswnwsenesewsw'),('nenenwsenwnwwnwwnwnenwnwnwnwnwnwenwnw'),('swneswswwswwwswswswseswswswswswwwsw'),('seneseseeweeeseeweeseweneese'),('sesenwseseseneseseseesesenwneswswnwnwse'),('swseswwswseswseseswswswseswswneswsesenwsese'),('wnwwwsenewswswswnewswswse'),('nwnwenwnenenwnwneenenwwwnwnenwswnwe'),('eeesweseeeeeeeeeeenewnee'),('swnwnwnwnwneneenenenenwnwnenenenwnenwnw'),('nenwwnwnwwsenenwnesenwswnwwwwewww'),('senenwswnewnwnwnewwnwsenwneneneneneenene'),('swseswseswswswsweswswswswswseswnwswsese'),('ewneesweneneeswneeneeneneneenwewne'),('wsewwnwwwnewnwnwswwwnwnewwwww'),('sewseneswseseeswneesewnweenwsweeese'),('swswswweswswwswwnwswneswswswswwwswsw'),('neswswswsewswwswswenwswsw'),('swswwenesesenwnwswswseenwse'),('nwnenwnwnwswenwnwnwnenwnwnwnwnwnwsenwnwsw'),('swenwnenwseeenweeeneneeeeeesw'),('nwnwnwnwnwsenwnwnwnwnwnwnwwnwwnwsenwnwne'),('eseeeseenwewseeeeeesenweeese'),('wwwwnwwwnewwwwwwwwwse'),('seswnesewwneseseseseseseseswsesesesese'),('seswswswswswswswswseseswswwneswswseswsw'),('nwnwenenwnenwnwnwenwnwnwnwnwnwnwnwswswnwnw'),('sesesesenesenwseseseneswwseswsenesewse'),('neswneswswswwseswwswswwwsenwswneswsww'),('nwnwwwnwnwwnwsewenwswnenenwnwswsenw'),('eseseeseseseeneeseseseseeswsese'),('nwwwnwenwnwnwwnwnwwnwwnwswwnenwnwnw'),('nwnwnwnwnwnwnwnwnwnwnwnwenwnwwnwwnwsesw'),('nwneswneneeeeeneseneeeeeesweene'),('seeseseseweseseeeseseeeesenwse'),('swneseswswseseeswswneseswswnwswswsewsw'),('wwnwnwswnwnwnewewnwwwnwwwwswwnwnw'),('nenenenewnenenwenenene'),('seseseswswswseseswseswnwsesesesw'),('senenesweseseweswswswseswsewneesenww'),('nwsewnwnwnwnwnwnwnwnwnwnenwnenwnwnwnwnw'),('seeeneenwesweeeese'),('wswwswwneswwswwswswwwwwsw'),('eeeseeeeeneneeeeweswnwneeswnwse'),('senwnenwnenenenwnwnwnwnenenwwnenenw'),('wwseswswswewnwwewwwwwwneswsw'),('eeeswseswseenweenweseeseswnenee'),('eeeeeeeeseeeeeeweneeese'),('eewenwneneneneswneneswnwsenenw'),('wenenenenwnwnwnenwswnenwnenwnwnwnwnenwnw'),('esesesesesenwsewsesesesesesenesesesese'),('wwwwweswswswww'),('weswswswswswswwswswswswswneswwswesw'),('eseseseseswnesesewseseenwswneswseww'),('seseesewseneeseseeseeseenewsesee'),('eeneeswenweeneeneeneeswseweene'),('eneenwnweeeeseeese'),('neneneneewneneseneneneeneenenewenene'),('eewsesweneweswnwnesese'),('ewwswswneswsenwswneswswswseswswwwsw'),('wnwsenwnwwnewwnwwseswswwewnwwwe'),('wswwwwwswswswswneswwswswswswwswe'),('wnwnwnwwwewwwwnwnwnwnw'),('nwesesenwwenwnwsewneswnenew'),('nenenenwswnenenenwnwnenenwneneneenenene'),('nwseswnwwnwnwwnwwnwnwnwnwnwseenwnwnwne'),('neneenwswwswnenesenwne'),('seswwseswwweswneswnenenwswsenwswwsw'),('nwseswswwswswswswnwseswnwwswseswswswsww'),('wwnewwwewwwwwwnwnwswwwwww'),('neneswnenwnenenenenenenwneneswnenwnenene'),('wwnwnwsesenwnwenwnwnwnwnwewnwnwnww'),('eneenwneneneneeeeneenesweesweee'),('swsewswwseseswswswseswseseeswswneswswsesw'),('swewwwwwwnwwswwwewwwnwnwwww'),('eeesenesewweseneseswweseeeesee'),('wnwweseenwwwwwnwwnwnwnesenewswse'),('nenenenenenesewnenenenenenenene'),('swseswneswneswsewswsesenwswswseseswswsw'),('wnwwwnwwenwnwswnwnwwnwwnwnwnwww'),('sewsenweeeseeseeeeeeeesesesee'),('enwsweweeeeneneeeeneeneswse'),('nwnwnewnwwnwwnwnwnwwnwnwnwsenwnwnwnw'),('swswwnesesewnwswswnwswswsewswswnewsw'),('swnesenwnwnwnwnenenwnw'),('neseeseseswwnwsenwswseswswnw'),('swswswneweswnwswwwwwseswwswsw'),('neneneswnwneneneneneswnenesenenenwnenwne'),('swseseeewneeseswseseeseneenweese'),('eseseeeenwseseeesesesee'),('wwnwwwwwnwwwwwnwwwswnwweew'),('newneeeneneeneene'),('swswwwswweswnwswswswswswswswwseswswsw'),('nwnwnwnwnwnenwneswnwnwsenwenwnwnwnwwnwnwnw'),('seswwwwwwwnwswwswneswswwswswswsw'),('neneenesenenweneesewenenweeswee'),('seseseseseseseseseseseswesesesesenwswse'),('neeneneenenenenenenesenesweneneeneenw'),('nwwswseeseewenwnwwewwnwnenwew'),('neswneneeneneenwnwnenenenwnwnewnenesw'),('nwesewnwnwnwnwnwnenwnwnw'),('nwnwnenwewenwnwnesewseswswnwnwenese'),('swsweswnwswseswnwswswswsweswswswswsesw'),('eweeneseeneeeeeeseeesweeee'),('ewsenwnwnwnwswnwnwswsenwnenwswnwnwnwnenw'),('enesenewwnwwseseswnwseesenenwseesese'),('wwwwnenwewwnwwwwwwnwwsewwesw'),('swwswwwseswnesewnew'),('neewswwsenwwsenwsewnwwnwnenwnwenw'),('eneneneesweeneneeneeneneenwneee'),('swswewswswwwswswswswseeswwswswswnwsw'),('wnenenewwneneesenesenwwsenwenwwsene'),('nweeswnwnwnwnwswnwnwenwwnenwsesenewnw'),('enwwwwnwwwwnwwnwnwwwnwwnweswnw'),('swnwwswswewwswswswnwwnesewwswswsw'),('nwenwnwwnenwswnwnwwnwnwnenenwneenwnw'),('neneneneewneneneseneeeneeesweneeee'),('swwseswwwswnwswwneneseswswewnewswswnw'),('swsenwneseenwnwnwswnwwnenwwswnenwwwse'),('nwnenwnwneneswnwnesenenw'),('sesweswswwsesesenwsewenweswswsese'),('ewswsenwsewnwsesweseneswswswwne'),('swseeenweeseneenwsewnw'),('nwwwewwwwnwwwnwwwwwwwewnw'),('newsenwneswnwnenwnwnwneenwnwnenwnwnenw'),('wwwewnwnwnwwwwwnwwwsenwwwnwnw'),('eseeseewnenewweneswneneeeneewe'),('swswnwswseswswswswswweswswswswswswswswsw'),('neeeseeeneeeeweseenwneeeee'),('enenwwenwnewswewwnwswwswnwswnew'),('wwwsesesewwwwwnwnwwnewwwwwwne'),('wwwwwwswswwwwwnenewswswwww'),('enweseeeeeeneneweeeeenenee'),('senenenenwnenenenenenewneeswnenenenenene'),('wnwwwwwwwwwwwswnewnwwwnw'),('eswwesenweneneeneenwenenenewswse'),('nwnwnwswnwnwneneneneswnwnw'),('sewswneswwsenwswwswseswwsweswnwswswsw'),('wseeneeneseseeseswsesweeseeeneese'),('nwnwnwswnwnwwwnwneswnwnwnwwwweswnew'),('seseseseswnwseseseesesesesesesesw'),('swswswswswnewswwswswswse'),('senwseseseseseswneseswseseseswwsesesesesw'),('wenwnwswnenwnwnwsewnwnwesenwwsenenesw'),('eneneweneeswneeseeeenee'),('sesewswnwseswswswsewswswseeeneswswene'),('nwwwnwwwwseewwwenwwwswnwwwwnw'),('wwswsewwwsenwwesewnwnwnwwnwnewww'),('seswseseewseswseseseswse'),('wnwwwnwwwwwswwwnesesewnewnew'),('swseswseseswswswswswsenwswsesweseswswnwsw'),('neeeseseseneseswseseeseseseswesesesee'),('eswnewneseeneenenene'),('wneneenweesenewneeeesenenee'),('neswnenwwswswswswswwnenwswseswseesww'),('nesenwnenwnwswnwnwswnenwnwnenwnw'),('nenenwneswnenenenenenenwnwnwnwnenwnwswenw'),('eeseseeeesenwsenweeeesee'),('esenesesesenesewseswsesesesesesesewsesene'),('swneneneneneneenenenenenenwnwneneswneneene'),('seswseseswseswseseseseswseneswswnwseswnw'),('eswnewneneneeneneneneeneswneswwnwne'),('nwnenwnwsenwnwnwsewnwnwnwnwnwnwsewnenwnw'),('neneneneswneesewwenwnesesenwswnwnwnenenw'),('neneswneenwnewnenenenenenwnenenenenenene'),('swwweswswweswwwswwswnwwwswnwswww'),('wwwwswnwwwwwswswse'),('swswswneswswswswswnwswswswswswswseswswwsw'),('newsenweneswenenenewneenwsenwwnewnw'),('eeseneeeweneenee'),('swswswswswswswsweswswswnwswnwsweswswsw'),('nwsenwnwnwwnwnenwnwwnwnwnwwswswnewne'),('enewsewneneeeenenenenenenenenesenene'),('newneeeeneneeseeenweeeeswee'),('seeewswwseswwneneswswswswwwswswesw'),('seseenesesesesesesewse'),('nwswnwnenwnwnesenwnwnwnenwnenene'),('eseseseeeeseenwseseeeswsesesenwesee'),('swnwseswseswnwseeenwswswswsewswesesw'),('wwwwnwwwswseeswnwwwwwwsw'),('wsenwwneewnwsww'),('senewswenesesesweseseeswseseseenesese'),('nwseseseeseseswseeseesesesenesesenwsw'),('nwnenwenenwnwwnenwswnwsenwnenw'),('seseeeeeneewweweeseneeeese'),('wseswswswnweswwwnwwwswswswwewswswsw'),('newenwnwnenwnenenwnwnenenwsenesenwswnwne'),('sweeeeeeneneeeeeneweswnwswe'),('swnwswenwnwswnenenwneenwnwnwnwnwnwnwnw'),('nwnwnwnwnwenwnwswnwswnwnwenwnwnwwnwnesese'),('eswneseenewsewwewsenesenesewneesese'),('neseeeeseseswsesewseseseewsesenesese'),('nenwwnesweeeneneneenenwnesw'),('wneeneesweneenene'),('eseeweeseseeeneeeeeeeeee'),('neenwneeweswnwswnwneneneneswewnwnwnese'),('nenenwnenwnenenenenewnwnwnwnesenenenwnw'),('neneeneweneseeeneeeneneeeeene'),('wseesweeeeseseenweeeseseeee'),('eswnwnewwnwswswewswsw'),('wewewneswsenenwenewwwwseswww'),('eswnwenwnwseseseenwnwwnenwnwweseswnwse'),('wswswswswseewneseswswwenwwneswnwswsee'),('swswswswenwsenwswswswswseswseswsesesw'),('nwswewwseenwswneeee'),('swnwwwnwewesewwenwwwnwwswww'),('nwnwswnwwnwnwnwwnwnwnwnwenwnwnwnwnwnw'),('eweseenweenesesee'),('wsenwnwseswwswswwnenwnweswnwseeewswnw'),('neeneneneeesweswnenwneneenenweneese'),('swswseswswswwwswswnwswswwweswwwnww'),('eeeseseneeweeeeeseenweeese'),('wswwwwnwnwnwsenenwwnwenw'),('nwnwnwnwnenwnwwwnwnwswnwswswnwewwe'),('ewewwwnwwswseseseseeeseneeseee'),('swwswwwwwwswewwwwwwwwew'),('seseseeesweswwenwnw'),('nwnwsewweswnwww'),('wwnewwwswwwsewswsw'),('seswwwwswewswwsewwwwwwnewwnww'),('wwwswnwswwnewwsewwwwwwswew'),('nwswswnenenwnenwsene'),('swswsesenwseswsesesweswswswswseswswsw'),('wwsweeswwwswwswswwnesw'),('nwnwnwsesesewnwewnwwnewnwwnwnwnwesw'),('enwwnwswwsweswneswnwwswnweeswsesw'),('neeeneseseeeenwneeneeeweweese'),('nwwsenwwnwwnwnwnwnwnwnwnw'),('nwnwnenwwswnwswnwnesenwnwwnweneewse'),('sweneswnesenenenewnenenenenwenwnwnenesenw'),('nwnenweeswnwsesenwnwnwnwnenwwenew'),('nweseeeseseseeeseseswneswseeeswsenwse'),('eneneeeneweneesene'),('nwnwswnenwnwnwnwnenwnwnenwnwsenenwnwwnwnwnw'),('swweswnwwswwswswneswwswnenwneswewsw'),('wswwwnwswwsewseewswswswwwwswne'),('nwnesenenenwewwneneseneneneewnenenese'),('neswwswswnwwwwswesweswwswswnewswnw'),('newenesenenwnenwwneswneseeenenwnene'),('nweswnwneswsenweeeesesesewenwee'),('nwsenenenenenenwwnenwnwnenenenenenwneneswne'),('swswswswswsenwneseswswswwswseswswswne'),('swneswswswswswseswsewswsw'),('senwesenwnwnwnwnwwnwwnewnwneswnwnwnw'),('seswseswswseswswseseswnwswnwswswseseese'),('nenenenenenenenwnwnenwneswnenenwne'),('nwnwnenwnenwnenwnenenwnwnenenenwneneesw'),('nwswnwnewnenwenenwnwnesenwnwnwnenenenenwnw'),('wswnwnewwwnwswsewwnwwswnesene'),('nwnenwnwnwenwnenwnewnwsenwswswnwwnwnwwnw'),('wwnewwswswwsewwwswwwsewwwnwww'),('sewnwenwnwsenewnw'),('seseseweswwswenenwswneswwswneswswsese'),('wseseseswsenwswwwnwwnenenenewswsww'),('nwnwenwnwwnwwwnwnwnwnwnwnwnwnwsenww'),('wsenewenenenenwneenwneswseenwswnww'),('seseseseseseswseseeseswseseseseswnwsesw'),('neenwneeeneseeneseneneeneneenenewe'),('eseswseseseseseseseesesesewneswnewsesw'),('eswneeesweswneeeeneeenwnweeeee'),('seseseswseswwswswswswswneseswnwseswswswswsw'),('swwwswnesewwwswswswswswwswswswnesew'),('ewsenenwswswwsewsesesenwsenwseneene'),('neneneneneenenweneneswnenenenenenewsene'),('wwenwseweswnwnwwwswwswwwewnew'),('eneeeenwweneeeeneeeneeeneswe'),('eenewnwswesenwneeseweeseseeswse'),('senwseesweseeswsesesesesenweeseesese'),('wswwsenenwewnwwnesewnwswwwsewnwnw'),('swneseswswweenwwwwwewwwswwsw')),
paths AS (
    SELECT regexp_split_to_table(replace(replace(replace(replace(column1, 'se', 'X'), 'nw', 'Y'), 'sw', 'A'), 'ne', 'B'),'') as way,
           row_number() over() as id
      FROM vals
),
existing_path AS (
    SELECT DISTINCT id
      FROM paths
),
grouped_path AS (
    SELECT id,
           way,
           count(*) as nbr
      FROM paths
  GROUP BY 1, 2
),
reduced_path AS (
    SELECT id,
           COALESCE(p1.nbr, 0) - COALESCE(p2.nbr, 0) as nw,
           COALESCE(p3.nbr, 0) - COALESCE(p4.nbr, 0) as ne,
           COALESCE(p5.nbr, 0) - COALESCE(p6.nbr, 0) as e

      FROM existing_path p
 LEFT JOIN LATERAL (SELECT nbr FROM grouped_path g where g.id=p.id AND g.way='Y') p1 ON TRUE
 LEFT JOIN LATERAL (SELECT nbr FROM grouped_path g where g.id=p.id AND g.way='X') p2 ON TRUE
 LEFT JOIN LATERAL (SELECT nbr FROM grouped_path g where g.id=p.id AND g.way='B') p3 ON TRUE
 LEFT JOIN LATERAL (SELECT nbr FROM grouped_path g where g.id=p.id AND g.way='A') p4 ON TRUE
 LEFT JOIN LATERAL (SELECT nbr FROM grouped_path g where g.id=p.id AND g.way='e') p5 ON TRUE
 LEFT JOIN LATERAL (SELECT nbr FROM grouped_path g where g.id=p.id AND g.way='w') p6 ON TRUE
  order by 1
),
converted_coord AS (
    SELECT id,
           nw+ne as y,
           e+ne as x
      FROM reduced_path
  ORDER BY 2,3
),
group_converted AS (
SELECT x,y,count(*) as nbr FROM converted_coord group by 1,2
)
SELECT count(*) FROM group_converted WHERE (nbr%2)=1;
